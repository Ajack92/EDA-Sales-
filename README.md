## EDA-Sales using SQL 

## SQL Exploratory Data Analysis (EDA) Project .

EDA is all about understanding the data using basic queries,aggregations and data profiling.
The Main objective of this Deep dive into raw sales data and pull insights using diamensions and measures and vice versa, of the data using tool SQL.


## Below are the Business questions and their queries.


### 1. Explore all objects in the DB

```sql
select * 
from INFORMATION_SCHEMA.tables
```

### 2. Explore all columns in the DB
```sql
select * from INFORMATION_SCHEMA.COLUMNS
where table_name = 'gold.dim_customers'
```

### 3. Explore all countries.

```sql
select distinct country
from [gold.dim_customers].
```

### 4. Explore all categories 'the major divsions'.
```sql
select distinct product_name, 
category,
subcategory
from [gold.dim_products]
order by 1,2,3
```

### 5. Date exploration (first and last date)

```sq
select min(order_date) as first_order_date,
max(order_date) as last_order_date,
datediff(year,min(order_date) ,max(order_date)) as order_range_year,
datediff(month,min(order_date) ,max(order_date)) as order_range_month,
datediff(day,min(order_date) ,max(order_date)) as order_range_days
from [gold.fact_sales]
```

### 6. find youngest and oldest customer

```sql
select
min(birthdate) as oldest_customer,
datediff(year,min(birthdate),getdate()) as oldest_age,
max(birthdate) as youngest_customer,
datediff(year,max(birthdate),getdate()) as youngest_age
from [gold.dim_customers]
```


### Aggreate using measures.

### 7. find the total sales

```sql
select sum(sales_amount) as total_sales
from [gold.fact_sales];
```
### 8. show how many items are sold

```sql
select sum(quantity) as no_of_items
from [gold.fact_sales]
```
### 9. find avg selling price 

```sql
select avg(price) as avg_selling_price
from [gold.fact_sales]
```

### 10. find total number of order

```sql
select count(order_number) as no_of_order from [gold.fact_sales]
select count(distinct order_number) as no_of_order from [gold.fact_sales]
```

### 11. find the total no: of products

```sql
select count(product_id) as no_of_products from [gold.dim_products]
select count(distinct product_id) as no_of_products from [gold.dim_products]
```

### 12. find the total no of customers

```sql
select count(customer_key)  as total_customers from [gold.dim_customers]
```
### 13. find the total no of customers that has placed order

```sql
select count(distinct customer_key)  as total_customers from [gold.fact_sales]
```
### 14. Generate a report that showws all key metrics of the business

```sql
select 'Total Sales' as measure_name ,sum(sales_amount) as measure_value  from [gold.fact_sales]
Union all
select 'Total Quantity' as measure_name ,sum(quantity) as measure_value  from [gold.fact_sales]
union all
select 'Average Price' as measure_name ,AVG(price) as measure_value  from [gold.fact_sales]
union all
select 'Total no: of Order' ,count(distinct order_number) as no_of_products from [gold.fact_sales]
union all
select 'Total no: of Products', count(distinct product_id)  from [gold.dim_products]
union all
select 'Total no: of customers' ,count(customer_key) from [gold.dim_customers]
```

##  Measure by Dimension

### 15. find total customers by countries

```sql
select 
country,
count(customer_key)  as total_customers 
from [gold.dim_customers]
group by country
order by 2 DESC
```

### 16. find the total customers by gender
```sql
select 
gender,
count(customer_key)  as total_customers 
from [gold.dim_customers]
group by gender
order by 2 DESC
```
### 17. find the total products by category.

```sql
select category,
count(product_id) as no_of_products
from [gold.dim_products]
group by category
order by 2 DESC
```

###18 What is the avergae costs in each category.

```sql
select 
category,
avg(cost) as avg_cost
from [gold.dim_products]
group by category
order by 2 DESC;
```
### 19. whats is the total revenue generated for each category

```sql
select 
p.category,
sum(s.sales_amount) as total_revenue
from [gold.fact_sales] as s
join [gold.dim_products] as p on p.product_key = s.product_key
group by p.category
order by 2 desc 
```

### 20. What is the total revenue generated by each customer

```sql
select 
c.customer_key,
c.first_name,
c.last_name,
sum(s.sales_amount) as total_revenue
from [gold.dim_customers] as c
join [gold.fact_sales] as s on c.customer_key = s.customer_key
group by c.customer_key,c.first_name,c.last_name
order by 4 desc 
```

### 21. what is the distribution of sold itemns across countries

```sql
select
c.country,
sum(s.quantity) as total_sold_items
from [gold.fact_sales] as s 
join [gold.dim_customers] as c on s.customer_key = c.customer_key
group by c.country
order by 2 desc
```

## Ranking Analysis 
## Rank diamension by measure

###22 Which 5 products generate the highest revenue?

```sql
select top 5 
p.product_name,
sum(s.sales_amount) as total_revenue
from [gold.dim_products] as p
join [gold.fact_sales] as s on p.product_key = s.product_key
group by p.product_name
order by 2 DESC ;
```

### 23. Which 5 sub_category generate the highest revenue?

```sql
select top 5
p.subcategory,
sum(s.sales_amount) as total_revenue
from [gold.dim_products] as p
join [gold.fact_sales] as s on p.product_key = s.product_key
group by p.subcategory
order by 2 DESC 
```

### 24. what are the 10 worst performing products in terms of sale?

```sql
select top 10
p.product_name,
sum(s.sales_amount) as total_revenue
from [gold.dim_products] as p
join [gold.fact_sales] as s on p.product_key = s.product_key
group by p.product_name
order by 2 ASC ;
```

### 25.  what are the 10 worst subcategory products in terms of sale?
```sql
select top 10
p.subcategory,
sum(s.sales_amount) as total_revenue
from [gold.dim_products] as p
join [gold.fact_sales] as s on p.product_key = s.product_key
group by p.subcategory
order by 2 ASC ;
```


## above using window functions
### 26. which 5 products generate the highest revenue?

```sql
select *
from(
	select 
	p.product_name,
	sum(s.sales_amount) as total_revenue,
	ROW_NUMBER() over(order by sum(s.sales_amount) DESC) as rank_products
	from [gold.dim_products] as p
	join [gold.fact_sales] as s on p.product_key = s.product_key
	group by p.product_name) t
where rank_products <= 5
```

### 27.  find top 10 customers who have generated the highest revenue

```sql
select top 10
c.customer_key,
c.first_name,
c.last_name,
sum(s.sales_amount) as total_revenue
from [gold.dim_customers] as c
join [gold.fact_sales] as s on c.customer_key = s.customer_key
group by c.customer_key,c.first_name,c.last_name
order by 4 desc 
```

### 28.  The top 3 customers with fewest orders

```sql
select top 3
c.customer_key,
c.first_name,
c.last_name,
count(distinct order_number) as total_order
from [gold.dim_customers] as c
join [gold.fact_sales] as s on c.customer_key = s.customer_key
group by c.customer_key,c.first_name,c.last_name
order by 4 ASC
```
